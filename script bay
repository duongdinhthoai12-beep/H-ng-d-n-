-- STAR★179 FIXED FLY
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local player = Players.LocalPlayer

local function getChar()
	return player.Character or player.CharacterAdded:Wait()
end

-- GUI
local gui = Instance.new("ScreenGui", player.PlayerGui)
gui.Name = "STAR179_FLY_FIX"

local main = Instance.new("Frame", gui)
main.Size = UDim2.new(0,420,0,260)
main.Position = UDim2.new(0.5,-210,0.5,-130)
main.BackgroundColor3 = Color3.fromRGB(30,30,30)
main.Active = true
main.Draggable = true

-- TITLE
local title = Instance.new("TextLabel", main)
title.Size = UDim2.new(1,0,0,35)
title.Text = "STAR★179"
title.TextScaled = true
title.Font = Enum.Font.GothamBold
title.BackgroundTransparency = 1

-- RAINBOW TITLE
task.spawn(function()
	local h = 0
	while gui.Parent do
		h = (h + 0.01) % 1
		title.TextColor3 = Color3.fromHSV(h,1,1)
		task.wait(0.03)
	end
end)

-- VARIABLES
local flying = false
local speed = 1
local minSpeed = 0.5
local maxSpeed = 10
local up = false
local down = false
local gyro, vel

-- SPEED LABEL
local speedLabel = Instance.new("TextLabel", main)
speedLabel.Size = UDim2.new(0,150,0,30)
speedLabel.Position = UDim2.new(0.5,-75,0,40)
speedLabel.Text = "Speed: 1.0"
speedLabel.TextScaled = true
speedLabel.BackgroundColor3 = Color3.fromRGB(50,50,50)
speedLabel.TextColor3 = Color3.new(1,1,1)

-- PLUS
local plus = Instance.new("TextButton", main)
plus.Size = UDim2.new(0,50,0,40)
plus.Position = UDim2.new(0.5,30,0,75)
plus.Text = "+"
plus.TextScaled = true

-- MINUS
local minus = Instance.new("TextButton", main)
minus.Size = UDim2.new(0,50,0,40)
minus.Position = UDim2.new(0.5,-80,0,75)
minus.Text = "-"
minus.TextScaled = true

local function updateSpeed()
	speedLabel.Text = string.format("Speed: %.1f", speed)
end

plus.MouseButton1Click:Connect(function()
	speed = math.clamp(speed + 0.5, minSpeed, maxSpeed)
	updateSpeed()
end)

minus.MouseButton1Click:Connect(function()
	speed = math.clamp(speed - 0.5, minSpeed, maxSpeed)
	updateSpeed()
end)

-- UP BUTTON
local upBtn = Instance.new("TextButton", main)
upBtn.Size = UDim2.new(0,50,0,50)
upBtn.Position = UDim2.new(0,20,0.5,-60)
upBtn.Text = "↑"
upBtn.TextScaled = true

-- DOWN BUTTON
local downBtn = Instance.new("TextButton", main)
downBtn.Size = UDim2.new(0,50,0,50)
downBtn.Position = UDim2.new(0,20,0.5,0)
downBtn.Text = "↓"
downBtn.TextScaled = true

upBtn.MouseButton1Down:Connect(function() up = true end)
upBtn.MouseButton1Up:Connect(function() up = false end)
downBtn.MouseButton1Down:Connect(function() down = true end)
downBtn.MouseButton1Up:Connect(function() down = false end)

-- FLY BUTTON
local flyBtn = Instance.new("TextButton", main)
flyBtn.Size = UDim2.new(0,120,0,50)
flyBtn.Position = UDim2.new(1,-130,1,-60)
flyBtn.Text = "FLY : OFF"
flyBtn.TextScaled = true
flyBtn.BackgroundColor3 = Color3.fromRGB(200,50,50)

flyBtn.MouseButton1Click:Connect(function()
	flying = not flying
	local char = getChar()
	local hrp = char:WaitForChild("HumanoidRootPart")

	if flying then
		flyBtn.Text = "FLY : ON"
		flyBtn.BackgroundColor3 = Color3.fromRGB(50,200,50)

		gyro = Instance.new("BodyGyro", hrp)
		gyro.MaxTorque = Vector3.new(9e9,9e9,9e9)
		gyro.P = 9e4

		vel = Instance.new("BodyVelocity", hrp)
		vel.MaxForce = Vector3.new(9e9,9e9,9e9)
		vel.Velocity = Vector3.zero

		RunService.RenderStepped:Connect(function()
			if not flying then return end
			gyro.CFrame = workspace.CurrentCamera.CFrame

			local move = Vector3.zero
			if up then move += Vector3.new(0, speed*10, 0) end
			if down then move -= Vector3.new(0, speed*10, 0) end

			vel.Velocity = move
		end)
	else
		flyBtn.Text = "FLY : OFF"
		flyBtn.BackgroundColor3 = Color3.fromRGB(200,50,50)
		if gyro then gyro:Destroy() end
		if vel then vel:Destroy() end
	end
end)

updateSpeed()